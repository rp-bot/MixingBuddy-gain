# @package model

# Model configuration for stem classification and gain regression
# Architecture: Audio Encoder -> (Optional Projection) -> Classification Head + Regression Head

# Name used by run-name utilities / logging
model_name: "stem_gain"

# Number of classes:
#   0: vocals
#   1: drums
#   2: bass
#   3: no_error  (mix is balanced, no adjustment needed)
num_classes: 4

# Feature pooling method: "mean", "max", or "attention"
pooling_method: "attention"  # Changed from "mean" - attention pooling can learn which time steps matter

# Audio encoder configuration - MERT
encoder:
  model_name: "m-a-p/MERT-v1-330M"
  freeze: true
  device: cuda
  input_sample_rate: 24000  # Match dataset sample rate (MERT's native rate is 24kHz)
  freeze_layer_weights: false

# Optional projection layer
# Set to null to skip projection (encoder -> heads directly)
# Or configure a projection layer
projection:
  type: "linear"
  output_dim: 512  # Increased from 256 to 512 for more capacity (still a bottleneck from 1024)
  dropout: 0.2     # Regularize the projection features

# Task head configuration (classification and regression)
# Configurable depth and architecture
head:
  hidden_dims: [256, 128]  # Increased capacity: 512 -> 256 -> 128 -> output (2 hidden layers)
  dropout: 0.3             # High dropout to force generalization
  activation: "relu"        # Options: "relu", "gelu", "tanh"
# Default (if head is null): [512] (2-layer: 1024 -> 512 -> output)


