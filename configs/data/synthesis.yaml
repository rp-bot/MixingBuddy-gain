paths:
  processed_root: data/musdb18hq_processed
  output_root: data/musdb18hq_processed
  musdb_root: data/musdb18hq

# Dataset paths
train_jsonl_path: data/musdb18hq_processed/train/training_samples.jsonl
train_audio_root: data/musdb18hq_processed/train/flawed_mixes
test_jsonl_path: data/musdb18hq_processed/test/test_samples.jsonl
test_audio_root: data/musdb18hq_processed/test/flawed_mixes

# Training parameters
error:
  priors:
    no_error: 0.20
    quiet: 0.20
    very_quiet: 0.20
    loud: 0.20
    very_loud: 0.20
  # Fixed dB ranges for each category (no IQR scaling)
  ranges_db:
    quiet: [-6, -3]
    very_quiet: [-12, -6]
    loud: [3, 6]
    very_loud: [6, 12]
  # Overall gain limits for safety
  gain_limits_db:
    min: -15.0
    max: 15.0

chunk:
  sec: 10.0

frame:
  ms: 50.0

gating:
  mixture_min_rms_dbfs: -30.0 # More lenient - allow quieter mixes
  stem_min_rms_dbfs: -40.0 # More lenient - allow quieter individual stems
  min_active_frame_ratio: 0.20 # More lenient - allow more silence

anchor:
  fallback_order:
    - bass
    - drums
    - other
    - vocals

audio:
  sample_rate: 32000 # Base sample rate - can be downsampled later for model input
  bit_depth: 24 # Audio bit depth: 16, 24, or 32 (float)
  # peak_normalize: false  # Removed - let audio clip naturally to preserve relative levels

limit: null # Set to a number to limit dataset size for testing
system_message: ""
use_instructions: false

splits:
  - train
  - test

output:
  flawed_mix_subdir: flawed_mixes
  train_samples: training_samples.jsonl
  test_samples: test_samples.jsonl

instruction_templates:
  - "You are listening to a {duration_sec}s segment of a track. The available stems are: {stems_present}. Please analyze the mix and provide mixing advice."
  - "This is a {duration_sec}s audio segment with stems: {stems_present}. Evaluate the mix balance and suggest improvements."
  - "Analyze this {duration_sec}s track segment. Stems present: {stems_present}. What mixing adjustments are needed?"
  - "Listen to this {duration_sec}s audio clip. Available tracks: {stems_present}. How should the mix be adjusted?"

response_templates:
  no_error:
    - "The mix sounds balanced. All elements are at appropriate levels."
    - "The balance is good. All instruments are sitting well in the mix."
    - "The mix is well-balanced. No adjustments needed."
    - "Everything sounds properly leveled. The mix is solid."

  quiet:
    - "The {target_stem} is too quiet. Increase the {target_stem} level by {intended_gain_db} dB to bring it up to the proper balance."
    - "The {target_stem} needs more presence. Boost it by {intended_gain_db} dB to balance the mix."
    - "The {target_stem} is getting lost. Bring it up by {intended_gain_db} dB."
    - "The {target_stem} is too low in the mix. Add {intended_gain_db} dB to fix the balance."

  very_quiet:
    - "The {target_stem} is much too quiet. Boost the {target_stem} by {intended_gain_db} dB to restore the mix balance."
    - "The {target_stem} is barely audible. Increase it by {intended_gain_db} dB to bring it forward."
    - "The {target_stem} is way too low. Add {intended_gain_db} dB to make it present."
    - "The {target_stem} needs a significant boost. Raise it by {intended_gain_db} dB."

  loud:
    - "The {target_stem} is too loud. Reduce the {target_stem} level by {abs_gain_db} dB to balance the mix."
    - "The {target_stem} is overpowering. Turn it down by {abs_gain_db} dB."
    - "The {target_stem} is too prominent. Cut it by {abs_gain_db} dB to balance."
    - "The {target_stem} needs to be quieter. Reduce by {abs_gain_db} dB."

  very_loud:
    - "The {target_stem} is overpowering. Cut the {target_stem} by {abs_gain_db} dB to fix the balance."
    - "The {target_stem} is way too loud. Bring it down by {abs_gain_db} dB."
    - "The {target_stem} is dominating the mix. Cut it by {abs_gain_db} dB."
    - "The {target_stem} is overwhelming. Reduce by {abs_gain_db} dB to balance."

rng:
  seed: 42
