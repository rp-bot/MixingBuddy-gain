paths:
  processed_root: data/musdb18hq_processed
  output_root: data/musdb18hq_processed
  musdb_root: data/musdb18hq

# Dataset paths
# Using the reduced no_error dataset (no_error reduced to 2x other categories)
train_jsonl_path: data/musdb18hq_processed/train/training_samples_augmented.jsonl
train_audio_root: data/musdb18hq_processed/train/flawed_mixes
test_jsonl_path: data/musdb18hq_processed/test/test_samples.jsonl
test_audio_root: data/musdb18hq_processed/test/flawed_mixes

# Training parameters
error:
  priors:
    no_error: 0.20
    quiet: 0.20
    very_quiet: 0.20
    loud: 0.20
    very_loud: 0.20
  # Fixed dB ranges for each category (no IQR scaling)
  ranges_db:
    quiet: [-3, -6]
    very_quiet: [-6, -12]
    loud: [3, 6]
    very_loud: [6, 12]
  # Overall gain limits for safety
  gain_limits_db:
    min: -15.0
    max: 15.0

chunk:
  sec: 10.0

frame:
  ms: 50.0

gating:
  mixture_min_rms_dbfs: -35.0 # More lenient - allow quieter mixes
  stem_min_rms_dbfs: -45.0 # More lenient - allow quieter individual stems
  min_active_frame_ratio: 0.20 # More lenient - allow more silence

target_stem:
  priors:
    bass: 0.33
    drums: 0.33
    vocals: 0.34
    other: 0.0

anchor:
  fallback_order:
    - bass
    - drums
    - vocals # Reordered: vocals before "other" is removed
  # Note: "other" excluded from fallback order
  # Anchor is selected as first available stem from fallback_order
  # that is NOT the target stem and NOT "other"

audio:
  sample_rate: 24000 # Base sample rate - can be downsampled later for model input
  bit_depth: 24 # Audio bit depth: 16, 24, or 32 (float)
  # peak_normalize: false  # Removed - let audio clip naturally to preserve relative levels
  silence_threshold: 1e-5

enumeration:
  enabled: true

logging:
  tqdm: true

limit: null # Set to a number to limit dataset size for testing
system_message: "You are a mixing engineer. You are given a segment of a track and you need to provide gain balancing advice."
use_instructions: true

splits:
  - train
  - test

output:
  flawed_mix_subdir: flawed_mixes
  train_samples: training_samples_augmented.jsonl
  test_samples: test_samples.jsonl
  output_suffix: "synthesis_instructions"

instruction_templates:
  - "Listen carefully to this {duration_sec}s audio clip. The available stems are: {stems_present}. Use {anchor_stem} as your reference point and analyze the mix balance. Identify which stem needs adjustment and by how much."

response_templates:
  no_error:
    - "After analyzing the mix, all stems are at appropriate levels and the balance is correct. The mix is well-balanced. No adjustments needed."

  quiet:
    - "The {target_stem} is a little too quiet. Increase the {target_stem} level between {min_gain_db} and {max_gain_db} dB to balance the mix."

  very_quiet:
    - "The {target_stem} is barely audible. Increase the {target_stem} level between {min_gain_db} and {max_gain_db} dB to balance the mix."

  loud:
    - "The {target_stem} is a little too loud. Reduce the {target_stem} level between {min_gain_db} and {max_gain_db} dB to balance the mix."

  very_loud:
    - "The {target_stem} is overwhelming. Reduce the {target_stem} level between {min_gain_db} and {max_gain_db} dB to balance the mix."

rng:
  seed: 42

